<div class="carts-container">
  <div class="carts-header">
    <div>
      <h1 class="carts-title">Gerenciamento de Carrinhos</h1>
      <p class="carts-subtitle">Visualize e gerencie todos os carrinhos do sistema</p>
    </div>
  </div>

  <!-- Campo de busca -->
  <div class="search-section">
    <div class="search-container">
      <input 
        type="text" 
        [(ngModel)]="searchId" 
        placeholder="Buscar carrinho por ID..."
        class="search-input"
        (input)="searchCartsById()"
      >
      <button 
        class="search-button"
        (click)="searchCartsById()"
      >
        <i class="fas fa-search"></i>
        Buscar
      </button>
      <button 
        class="clear-button"
        (click)="clearSearch()"
        *ngIf="searchId"
      >
        Limpar
      </button>
    </div>
  </div>

  <!-- Mensagem de erro -->
  <div class="error-message" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <!-- Loading -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Carregando carrinhos...</p>
  </div>

  <!-- Tabela de carrinhos -->
  <div class="table-container" *ngIf="!isLoading && filteredCarts.length > 0">
    <table class="carts-table">
      <thead>
        <tr>
          <th>ID do Carrinho</th>
          <th>Usuário</th>
          <th>Email</th>
          <th>Produtos</th>
          <th>Preço Total</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cart of filteredCarts" 
            class="cart-row"
            [class.highlight]="cart.status === 'open'"
            [class.warning]="cart.status === 'pending'">
          <td class="cart-id" data-label="ID do Carrinho">{{ cart.id }}</td>
          <td class="user-name" data-label="Usuário">{{ cart.user.name }}</td>
          <td class="user-email" data-label="Email">{{ cart.user.email }}</td>
          <td class="products-count" data-label="Produtos">
            {{ cart.productResponses.length }} produto(s)
          </td>
          <td class="total-price" data-label="Preço Total">
            R$ {{ cart.totalPrice.toFixed(2) }}
          </td>
          <td class="status" data-label="Status">
            <span [class]="'status-badge ' + getStatusClass(cart.status)">
              {{ cart.status }}
            </span>
          </td>
          <td class="actions" data-label="Ações">
            <button 
              class="action-button edit-button"
              (click)="editCart(cart.id)"
              title="Editar carrinho"
            >
              <i class="fas fa-edit"></i>
            </button>
            <button 
              class="action-button close-button"
              (click)="closeCart(cart.id)"
              title="Fechar carrinho"
            >
              <i class="fas fa-lock"></i>
            </button>
            <button 
              class="action-button delete-button"
              (click)="deleteCart(cart.id)"
              title="Deletar carrinho"
            >
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mensagem quando não há carrinhos -->
  <div class="no-carts" *ngIf="!isLoading && filteredCarts.length === 0">
    <i class="fas fa-shopping-cart"></i>
    <p>Nenhum carrinho encontrado</p>
    <p *ngIf="searchId">Tente ajustar os critérios de busca</p>
  </div>
</div>

<div class="category-container">
  <!-- Título da página -->
  <div class="page-header">
    <h1>Gerenciamento de Categorias</h1>
    <p>Visualize, edite e gerencie todas as categorias do sistema</p>
  </div>

  <!-- Campo de busca e botão de criação -->
  <div class="search-section">
    <div class="search-container">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="filterCategories()"
        placeholder="Buscar categorias por nome..."
        class="search-input"
      >
      <button class="btn-create" (click)="openCreateModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Criar Nova Categoria
      </button>
    </div>
  </div>

  <!-- Tabela de categorias -->
  <div class="table-container">
    <div class="table-header">
      <h3>Lista de Categorias</h3>
      <span class="category-count">{{ filteredCategories.length }} categoria(s) encontrada(s)</span>
    </div>

    <div class="table-wrapper">
      <table class="categories-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome da Categoria</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="isLoading" class="loading-row">
            <td colspan="3" class="loading-cell">
              <div class="loading-spinner">Carregando categorias...</div>
            </td>
          </tr>
          
          <tr *ngIf="!isLoading && filteredCategories.length === 0" class="empty-row">
            <td colspan="3" class="empty-cell">
              <div class="empty-message">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M8 12h8"></path>
                  <path d="M12 8v8"></path>
                </svg>
                <p>Nenhuma categoria encontrada</p>
                <span>Não há categorias para exibir no momento.</span>
              </div>
            </td>
          </tr>

          <tr *ngFor="let category of filteredCategories" class="category-row">
            <td class="category-id" data-label="ID">{{ category.id }}</td>
            <td class="category-name" data-label="Nome da Categoria">{{ category.name }}</td>
            <td class="actions-cell" data-label="Ações">
              <div class="action-buttons">
                <button 
                  class="action-btn edit-btn" 
                  (click)="onEditCategory(category.id)"
                  title="Editar categoria"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                  </svg>
                </button>
                
                <button 
                  class="action-btn delete-btn" 
                  (click)="onDeleteCategory(category)"
                  title="Deletar categoria"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3,6 5,6 21,6"></polyline>
                    <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal de Confirmação de Exclusão -->
<div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeDeleteModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Confirmar Exclusão</h3>
      <button class="btn-close" (click)="closeDeleteModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <p>Tem certeza que deseja excluir a categoria "{{categoryToDelete?.name}}"?</p>
      <p class="warning">Esta ação não pode ser desfeita.</p>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" (click)="closeDeleteModal()" [disabled]="deleteLoading">Cancelar</button>
      <button class="btn-confirm-delete" (click)="confirmDelete()" [disabled]="deleteLoading">
        <span *ngIf="!deleteLoading">Excluir</span>
        <span *ngIf="deleteLoading">
          <div class="loading-spinner-small"></div>
          Excluindo...
        </span>
      </button>
    </div>
  </div>
</div>
<!-- Modal de Criação de Categoria -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeCreateModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Criar Nova Categoria</h3>
      <button class="btn-close" (click)="closeCreateModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <form (ngSubmit)="createCategory()">
        <div class="form-group">
          <label for="name">Nome da Categoria</label>
          <input type="text" id="name" name="name" [(ngModel)]="newCategory.name" required class="form-input">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-cancel" (click)="closeCreateModal()">Cancelar</button>
          <button type="submit" class="btn-create">Criar</button>
        </div>
      </form>
    </div>
  </div>
</div>

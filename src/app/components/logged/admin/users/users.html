<div class="users-container">
  <div class="header-section">
    <h1 class="page-title">Gerenciamento de Usuários</h1>
    <p class="page-description">Visualize e gerencie todos os usuários do sistema</p>
  </div>

  <div class="search-section">
    <div class="search-container">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="onSearchChange()"
        placeholder="Buscar usuários por nome ou email..."
        class="search-input"
      >
    </div>
  </div>

  <div class="table-section">
    <div class="table-container">
      <table class="users-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Email</th>
            <th>Telefone</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="isLoading" class="loading-row">
            <td colspan="5" class="loading-cell">
              <div class="loading-spinner">Carregando usuários...</div>
            </td>
          </tr>
          
          <tr *ngIf="!isLoading && filteredUsers.length === 0" class="no-data-row">
            <td colspan="5" class="no-data-cell">
              <div class="no-data-message">
                <span *ngIf="searchTerm">Nenhum usuário encontrado para "{{ searchTerm }}"</span>
                <span *ngIf="!searchTerm">Nenhum usuário cadastrado</span>
              </div>
            </td>
          </tr>

          <tr *ngFor="let user of filteredUsers" class="user-row">
            <td>{{ user.id }}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.numberPhone }}</td>
            <td class="actions-cell">
              <button 
                class="edit-btn" 
                (click)="openEditModal(user)"
                title="Editar usuário"
              >
                Editar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>
</div>

<!-- Modal de Edição de Usuário -->
<div *ngIf="showEditModal" class="modal-overlay" (click)="closeEditModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Editar Usuário</h2>
      <button class="close-btn" (click)="closeEditModal()">&times;</button>
    </div>
    
    <form class="edit-form" (ngSubmit)="updateUser()">
      <div class="form-group">
        <label for="editName">Nome:</label>
        <input 
          type="text" 
          id="editName" 
          name="editName"
          [(ngModel)]="editingUser.name" 
          required
          class="form-input"
        >
      </div>
      
      <div class="form-group">
        <label for="editEmail">Email:</label>
        <input 
          type="email" 
          id="editEmail" 
          name="editEmail"
          [(ngModel)]="editingUser.email" 
          required
          class="form-input"
        >
      </div>
      
      <div class="form-group">
        <label for="editPhone">Telefone:</label>
        <input 
          type="text" 
          id="editPhone" 
          name="editPhone"
          [(ngModel)]="editingUser.numberPhone" 
          required
          class="form-input"
        >
      </div>
      
      <div class="form-group">
        <label for="editPassword">Nova Senha (deixe em branco para manter a atual):</label>
        <input 
          type="password" 
          id="editPassword" 
          name="editPassword"
          [(ngModel)]="editingUser.password" 
          class="form-input"
        >
      </div>
      
      <div class="form-actions">
        <button type="button" class="cancel-btn" (click)="closeEditModal()">
          Cancelar
        </button>
        <button type="submit" class="save-btn" [disabled]="isUpdating || !editingUser.name || !editingUser.email || !editingUser.numberPhone">
          <span *ngIf="!isUpdating">Salvar</span>
          <span *ngIf="isUpdating">Salvando...</span>
        </button>
      </div>
    </form>
  </div>
</div>
